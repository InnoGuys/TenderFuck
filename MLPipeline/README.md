для краткого объяснения, что какой файл делает, зайдите в коммит, которым этот файл создавался, там плюс-минус написано

# Система рекоммендаций 
и как она работает

## ...если коротко, то

* SentenceTransformers
* [Модель для русского языка от Сбера](https://huggingface.co/sberbank-ai/sbert_large_nlu_ru)
* NumPy
* Pandas

... и это все как-то там колбасится, автор решения после пары бессонных ночей
 и сам слабо представляет че там ваще происходит.
 
## Но вообще,

## Если подлиннее, то
* Каждой компании-закупщику присваивается вектор.
Это среднее значение семантических векторов всех типов заказов, сделанных
компанией.

---

Это позволяет при предсказании заказов учитывать категорию компании и специфику ее деятельности (регион, например, если это применимо, ибо не станет Сочинский 
ЖЭУ заказывать снегоочиститель, в отличии от Московского)

---

*  Мы, когда делаем предсказания, смотрим только на закупщиков, близких к нам по вектору
* Разработано два способа предсказания 
  * Один метод предназначен для оценки следующих запкупаемых предметов
  * Другой метод предназначен для поиска иных потенциально интересных для заказчика товаров

---

Оба метода работают с историей заказов клиента и прочих компаний.

**Первый метод** среди истории закупок схожих компаний (включая данную) ищет последовательности заказов, семантически схожие с
последними заказами, присваивает им коэффициент схожести и предсказывает, что следующим заказом окажется то,
 что в похожих случаях заказывают похожие компании, с похожим промежутком времени.

**Второй метод** чутка хитрее. Он тоже ищет схожие последовательности в историях заказов схожих с нашей компаний, но не
схожие последовательности семантических векторов, а схожие траектории в семантическом пространстве. 
Как известно, разности 

*"Лондон" - "Британия" и "Москва" - "Россия"*

в большинстве семантических пространств имеют близкие значения.

Для нас это (грубо говоря и очень приблизительно) означает, что если один человек заказал последовательность товаров:

*Монитор -- кронштейн -- дрель,*

а другой человек - 

*Дверь -- петли -- ???,*

Мы можем попытаться предположить, имея семантическую модель, что третьим пунктом будет какая-нибудь отвертка
или что-нибудь в таком роде, прибавив к 


*"петли"* 

разность 

*"кронштейн" - "дрель"*

Это и проделывает второй метод, находя сначала вектор предполагаемой следующей закупки, а затем находя среди всех товаров тот, семантический вектор названия которого наиболее похож на найденный.
